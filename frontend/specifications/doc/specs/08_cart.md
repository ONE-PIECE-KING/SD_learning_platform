# 購物車 頁面規格書

## 頁面資訊

| 項目     | 說明                                 |
| -------- | ------------------------------------ |
| 路徑     | `/cart`                              |
| 角色權限 | 需登入；未登入時引導至登入頁         |
| 核心目的 | 管理已選課程，完成結帳與付款流程     |

---

## 頁面結構

| 區塊           | 說明                                                     |
| -------------- | -------------------------------------------------------- |
| 課程清單       | 左側主欄，展示已加入購物車的課程                         |
| 結帳摘要       | 右側側欄（Desktop 2:1 / Mobile 底部 Sticky）             |

---

## 元件規格

### 課程清單（Course List）

| 欄位         | 說明                                   |
| ------------ | -------------------------------------- |
| 課程縮圖     | `thumbnail`                            |
| 課程標題     | 點擊導向詳情頁                         |
| 講師名稱     | `instructor`                           |
| 售價         | 目前售價                               |
| 移除按鈕     | 點擊後從清單消失，重新計算總額         |

**資料來源：** 遍歷本地存儲的 `course_ids`，逐一呼叫 `GET /api/v1/courses/{id}`

### 結帳摘要（Order Summary）

| 欄位         | 計算方式                               |
| ------------ | -------------------------------------- |
| 小計         | 所有課程售價加總                       |
| 折扣         | 暫定 0（或優惠碼邏輯）                |
| 應付總額     | 小計 - 折扣                            |
| 確認結帳按鈕 | 建立訂單並導向付款                     |

---

## API 整合

### 課程資料獲取

```
GET /api/v1/courses/{id}
```

- 根據 LocalStorage 中的 `course_ids` 逐一獲取課程資訊

### 訂單建立

```
POST /api/v1/orders
```

- **請求：** `{ items: [course_ids] }`
- **回應：** `{ order_id, total_amount, currency, items }`

### 付款

```
POST /api/v1/orders/{id}/pay
```

- **回應：** `{ payment_url }` → 導向金流頁面

### 身份驗證攔截

- 進入頁面檢查 LocalStorage 是否有 `accessToken`
- 若無：顯示登入彈窗或導向 `/auth/login`
- Token 失效時呼叫 `POST /api/v1/auth/refresh`

---

## 狀態與錯誤處理

| 狀態             | 處理方式                                     |
| ---------------- | -------------------------------------------- |
| Loading          | 按鈕 Disabled + Spinner 動畫                 |
| 空購物車         | 顯示「你的購物車是空的」+ 「去逛逛課程」按鈕 |
| 付款失敗         | Toast 提示使用者錯誤原因                     |

---

## 交互行為

| 行為           | 說明                                     |
| -------------- | ---------------------------------------- |
| 即時計算       | 移除項目後即時重算總額                   |
| 響應式         | Mobile 結帳摘要改為底部 Sticky           |
| 優惠碼輸入     | 輸入後即時驗證並更新折扣金額             |
