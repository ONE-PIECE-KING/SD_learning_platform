# 通知組件 規格書

## 組件資訊

| 項目     | 說明                                                       |
| -------- | ---------------------------------------------------------- |
| 類型     | 全域組件（Header 內嵌下拉面板）                            |
| 掛載位置 | Header 右側，購物車圖示旁                                  |
| 角色權限 | 已登入使用者可見；未登入時不顯示                           |
| 核心目的 | 即時顯示課程更新、訂單狀態、諮詢提醒、系統公告等通知       |

---

## 組件結構

### 觸發按鈕（Notification Bell）

| 元素         | 說明                                                 |
| ------------ | ---------------------------------------------------- |
| 鈴鐺圖示     | Header 右側圖示按鈕                                  |
| 未讀徽章     | 紅色圓形數字徽章，顯示未讀通知數量（超過 99 顯示 99+）|
| 點擊行為     | 展開/收合通知下拉面板                                |

### 下拉面板（Notification Panel）

| 區塊             | 說明                                                     |
| ---------------- | -------------------------------------------------------- |
| 面板標題列       | 「通知」標題 + 「全部標為已讀」按鈕                      |
| 分類 Tab         | 全部、課程、訂單、諮詢、系統                             |
| 通知列表         | 依時間倒序排列的通知項目                                 |
| 底部             | 「查看全部通知」連結（展開完整列表視圖）                 |

### 通知項目（Notification Item）

| 欄位         | 說明                                                 |
| ------------ | ---------------------------------------------------- |
| 圖示         | 依通知類型顯示對應圖示（課程/訂單/諮詢/系統）        |
| 標題         | 通知摘要（最多 1 行，超出省略號）                    |
| 描述         | 通知詳細內容（最多 2 行）                            |
| 時間戳       | 相對時間（如「3 分鐘前」「昨天」）                   |
| 未讀指示     | 左側藍色圓點標示未讀狀態                             |
| 點擊行為     | 標記為已讀 + 導向相關頁面                            |

---

## 通知類型

| 類型 | 觸發場景 | 導向頁面 |
| ---- | -------- | -------- |
| 課程更新 | 已購課程新增章節/單元 | `/dashboard/my-courses` |
| 訂單狀態 | 付款成功、退款完成 | `/dashboard/history` |
| 諮詢提醒 | 諮詢即將開始（30 分鐘前）、導師回覆 | `/dashboard/consult` |
| 系統公告 | 平台維護、功能更新、促銷活動 | 對應公告頁面或外部連結 |

---

## 視覺規格

| 屬性           | 規格                                             |
| -------------- | ------------------------------------------------ |
| 面板寬度       | 360px（Desktop）/ 全寬（Mobile）                 |
| 面板最大高度   | 480px，超出可捲動                                |
| 未讀徽章       | 紅色圓形（`--status-error`），白色文字，min-width 18px |
| 未讀指示圓點   | 8px 藍色圓點（`--primary`）                      |
| 遮罩           | 點擊面板外區域關閉面板                           |
| 動畫           | 面板展開 fade-in + slide-down，收合反向           |

### 響應式行為

| 斷點     | 行為                                           |
| -------- | ---------------------------------------------- |
| Desktop  | 下拉面板固定寬度 360px，錨定於鈴鐺圖示下方     |
| Mobile   | 全寬面板從頂部滑入，類似 Bottom Sheet 反向      |

---

## API 整合

### 通知列表獲取

```
GET /api/v1/notifications?type={type}&page={n}&limit=20
```

- 支援依類型篩選
- 回傳通知列表與未讀數量

**回應結構：**

```json
{
  "unread_count": "number",
  "notifications": [
    {
      "id": "string",
      "type": "course | order | consult | system",
      "title": "string",
      "description": "string",
      "is_read": "boolean",
      "created_at": "ISO 8601",
      "action_url": "string"
    }
  ]
}
```

### 標記已讀

```
PUT /api/v1/notifications/{id}/read
```

- 單則通知標記為已讀

```
PUT /api/v1/notifications/read-all
```

- 全部標記為已讀

### 即時推送（選配）

- WebSocket 或 SSE 連線，即時接收新通知
- 收到新通知時更新未讀徽章數字

---

## 狀態與錯誤處理

| 狀態           | 處理方式                                   |
| -------------- | ------------------------------------------ |
| Loading        | 通知列表使用 Skeleton Screen               |
| 無通知         | 顯示空狀態插圖 +「目前沒有通知」文字       |
| API Error      | 顯示「載入失敗」+ 重試按鈕                 |
| 未登入         | 鈴鐺圖示不顯示                             |

---

## 交互行為

| 行為           | 說明                                                 |
| -------------- | ---------------------------------------------------- |
| 即時更新       | 新通知到達時鈴鐺圖示震動動畫 + 徽章數字更新         |
| 滑動刪除       | （Mobile）左滑單則通知可刪除                         |
| 鍵盤支援       | Esc 鍵關閉面板                                       |
| 無限捲動       | 面板內滾動到底部時載入更多歷史通知                   |
